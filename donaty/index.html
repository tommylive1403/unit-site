<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Актуальний збір — Собаки Шукачі</title>

  <meta name="description" content="Підтримай підрозділ безпілотних систем. Актуальний збір.">
  <meta property="og:title" content="Актуальний збір — Собаки Шукачі">
  <meta property="og:description" content="Підтримай підрозділ безпілотних систем">
  <meta property="og:type" content="website">
  <meta property="og:url" content="/donaty">
  <meta property="og:image" content="/og-cover.jpg">

  <link rel="stylesheet" href="/style.css">
</head>

<body>

<header class="header">
  <div class="header__inner">
    <a href="/" class="brand">
      <span class="brand__name">СОБАКИ ШУКАКИ</span>
    </a>
    <nav class="nav">
      <a href="/#about">Про підрозділ</a>
      <a href="/#values">Цінності</a>
      <a href="/donaty">Донати</a>
    </nav>
  </div>
</header>

<main class="donatyWrap">

  <section class="donatyCard">

    <p class="donatyHero__kicker">Підрозділ безпілотних систем</p>

    <img src="/logo.png" alt="Собаки Шукачі" class="donatyHero__logo">

    <div class="donatyMeta">
      <div class="chip">ЦІЛЬ: <b id="goalUah">—</b></div>
      <div class="chip">ЗІБРАНО: <b id="raisedUah">—</b></div>
    </div>

    <div class="prog">
      <div class="prog__top">
        <span id="titleText">Збір активний</span>
        <span><span id="pct">0</span>%</span>
      </div>

      <div class="bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
        <div class="bar__fill" id="fill"></div>
      </div>
    </div>

    <a id="monoBtn"
       class="btnMono"
       href="https://send.monobank.ua/jar/4g2vud36xP"
       target="_blank" rel="noopener">
      ПІДТРИМАТИ ЧЕРЕЗ MONOBANK
    </a>

  </section>

</main>

<footer class="footer">
  <div class="footer__inner">
    <div>Собаки Шукачі</div>
    <div>© <span id="y"></span></div>
  </div>
</footer>

<script>
const DATA_URL = "/donaty/donaty.json";

const fmt = (n) =>
  new Intl.NumberFormat("uk-UA").format(Math.round(n)) + " грн";

async function loadDonation() {
  try {
    const r = await fetch(DATA_URL + "?v=" + Date.now(), { cache: "no-store" });
    if (!r.ok) throw new Error("JSON not found");

    const data = await r.json();

    document.getElementById("titleText").textContent = data.title;
    document.getElementById("goalUah").textContent = fmt(data.goal);
    document.getElementById("raisedUah").textContent = fmt(data.raised);

    const pct = Math.max(0, Math.min(100, (data.raised / data.goal) * 100));
    document.getElementById("pct").textContent =
      pct < 10 ? pct.toFixed(1) : pct.toFixed(0);

    document.getElementById("fill").style.width = pct.toFixed(2) + "%";
    document.getElementById("monoBtn").href = data.mono_url;

  } catch (e) {
    console.error(e);
    document.getElementById("titleText").textContent =
      "Збір тимчасово недоступний";
  }
}

loadDonation();
document.getElementById("y").textContent = new Date().getFullYear();
</script>

</body>
</html>
